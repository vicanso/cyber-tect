import{x as a,F as w,y as _,z as F,A as S,B as d,C as k,s as C}from"./index-aeeb7070.js";import{d as v,I as R,J as A,K as B,j as f,b as l,r as q,f as U,N as u,c as E}from"./ui-32540f7e.js";import{u as D,C as b,e as I}from"./naive-094f875f.js";const N={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},O=B("path",{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42s-42-18.804-42-42s18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z",fill:"currentColor"},null,-1),j=[O],H=v({name:"InfoCircle",render:function(t,s){return R(),A("svg",N,j)}}),P="userTracker",L="httpRequest",K="httpError";function T(e,t){return e._time===t._time?0:e._time>t._time?-1:1}const r=f({processing:!1,items:[],count:-1,flux:""}),g=f({processing:!1,items:[]});function X(e){if(e.error){const s=/, message=([\s\S]*)/.exec(e.error);s&&s.length===2&&(e.error=`${s[1]}, ${e.error.replace(s[0],"")}`)}e.result==="0"?e.resultDesc="成功":e.resultDesc="失败",e.key=e._time,e.createdAt=d(e._time)}const p=f({processing:!1,items:[]}),n=f({processing:!1,items:[],count:-1,flux:""});function z(e){e.key=e._time,e.createdAt=d(e._time)}const i=f({processing:!1,items:[],count:-1,flux:""}),x=f({processing:!1,items:[]}),y=f({processing:!1,items:[]});function V(e){e.key=e._time,e.createdAt=d(e._time)}async function Z(e){if(!r.processing)try{r.processing=!0;const{data:t}=await a.get(w,{params:e});r.items=t.trackers||[],r.items.sort(T),r.count=t.count||0,r.flux=t.flux||"",r.items.forEach(X)}finally{r.processing=!1}}async function ee(){if(!(g.processing||g.items.length!==0))try{g.processing=!0;const e=_.replace(":measurement",P).replace(":tag","action"),{data:t}=await a.get(e);g.items=(t.values||[]).sort()}finally{g.processing=!1}}function te(){r.items.length=0,r.count=-1,r.flux=""}async function se(){if(!(p.processing||p.items.length!==0))try{p.processing=!0;const e=_.replace(":measurement",K).replace(":tag","category"),{data:t}=await a.get(e);p.items=(t.values||[]).sort()}finally{p.processing=!1}}async function re(e){if(!n.processing)try{n.processing=!0;const{data:t}=await a.get(F,{params:e});n.items=t.httpErrors||[],n.count=t.count||0,n.flux=t.flux||"",n.items.forEach(z),n.items.sort(T)}finally{n.processing=!1}}function ne(){n.items.length=0,n.count=-1,n.flux=""}async function ie(e){if(!i.processing)try{i.processing=!0;const{data:t}=await a.get(S,{params:e});i.items=t.requests||[],i.count=t.count||0,i.flux=t.flux||"",i.items.forEach(V),i.items.sort(T)}finally{i.processing=!1}}function ue(){i.items.length=0,i.count=-1,i.flux=""}async function ae(){if(!(x.processing||x.items.length!==0))try{x.processing=!0;const e=_.replace(":measurement",L).replace(":tag","service"),{data:t}=await a.get(e);x.items=t.values||[]}finally{x.processing=!1}}async function ce(){if(!(y.processing||y.items.length!==0))try{y.processing=!0;const e=_.replace(":measurement",L).replace(":tag","route"),{data:t}=await a.get(e);y.items=t.values||[]}finally{y.processing=!1}}async function M(e){const t=k.replace(":measurement",e.measurement),{data:s}=await a.get(t,{params:Object.assign({time:e.time},e.tags)});return s}const $={userTrackers:l(r),userTrackerActions:l(g),httpErrors:l(n),httpErrorCategories:l(p),requests:l(i),requestServices:l(x),requestRoutes:l(y)};function oe(){return $}const G="i18la4si",J=v({name:"FluxDetailList",props:{measurement:{type:String,required:!0},time:{type:String,required:!0},tags:{type:Object,required:!0}},setup(e){const t=D(),s=q(!0),c=q([]);return U(async()=>{try{const o=await M({measurement:e.measurement,time:e.time,tags:e.tags}),h=["_measurement","_start","_stop","_time","result","table"];Object.keys(o).forEach(m=>{h.includes(m)||c.value.push({name:m,value:o[m]})})}catch(o){C(t,o)}finally{s.value=!1}}),{processing:s,values:c}},render(){const{processing:e,values:t}=this;if(e)return u("span",null,[E("正在加载中...")]);if(t.length===0)return u("span",null,[E("很抱歉，无符合记录")]);const s=t.map(c=>u("li",null,[u("span",{class:"mright5"},[c.name,E(":")]),E(" "),String(c.value)]));return u("ul",{class:G},[s])}}),le=v({name:"ExFluxDetail",props:{measurement:{type:String,required:!0},data:{type:Object,required:!0},tagKeys:{type:Array,required:!0}},render(){const{data:e,measurement:t,tagKeys:s}=this.$props,c={trigger:()=>u(I,null,{default:()=>[u(H,null,null)]})},o={};return Object.keys(e).forEach(h=>{if(!s.includes(h))return;const m=e[h];m&&(o[h]=m)}),u(b,{trigger:"hover",placement:"top-end",delay:500,duration:1e3},{default:()=>[u(J,{measurement:t,time:e._time,tags:o},null)],...c})}});export{le as E,te as a,Z as b,se as c,ne as d,re as e,ee as f,K as g,ae as h,ce as i,ue as j,ie as k,L as l,P as m,oe as u};
