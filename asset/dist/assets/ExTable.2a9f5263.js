import{K as j,L as H,M as B,J as R,s as q}from"./index.14cddf8e.js";import{F as m}from"./ExFormInterface.d1e14f35.js";import{u as X,y as $,H as K,E as M,F as Q,G as W,B as O,x as Y,w as G,d as _,s as Z,t as ee,v as te,I as ae,J as le,r as ne,e as re}from"./naive.650dd42a.js";import{h as J,E as se,G as a,D as ue,r as v,b as oe,f as E,J as ie}from"./ui.c327b114.js";const ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 576 512"},de=a("path",{d:"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9L216.2 301.8l-7.3 65.3l65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1l30.9-30.9c4-4.2 4-10.8-.1-14.9z",fill:"currentColor"},null,-1);var fe=J({name:"EditRegular",render:function(n,l){return ue(),se("svg",ce,[de])}});function S(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ie(e)}const pe="pyx5alf",he="u13tuy86";function ke(e){return{title:e.title,key:e.key,width:e.width,render:n=>{const l=n[e.key];if(!l||l.length===0)return"--";const u=l.map(s=>a("li",null,[s]));return a("ul",{class:he},[u])}}}function Ne(e){return{title:e.title,width:e.width,key:e.key,render:n=>{const l=e.key.split("."),u=l.pop()||"";let s=n;return l.forEach(p=>s=s[p]),a("span",null,[s[u]])}}}function Ve(e){return{title:"\u64CD\u4F5C",key:"op",width:80,render(n){return a(_,{bordered:!1,onClick:()=>{e(n)}},{default:()=>[a(re,null,{default:()=>[a(fe,null,null)]}),E("\u66F4\u65B0")]})}}}function me(e){if(e.length<2)return!1;const n=e[0],l=e[e.length-1];return!(n!=="{"&&n!=="["||l!=="}"&&l!=="]")}function De(e){return{type:"expand",expandable:()=>!0,renderExpand:n=>{const l=n[e];return me(l.trim())?a("pre",null,[JSON.stringify(JSON.parse(l),null,2)]):l}}}var xe=J({name:"ExTable",props:{title:{type:String,default:""},columns:{type:Array,required:!0},data:{type:Object,required:!0},fetch:{type:Function,required:!0},limit:{type:Number,default:15},filters:{type:Array,default:()=>[]},hidePagination:{type:Boolean,default:()=>!1},disableAutoFetch:{type:Boolean,default:()=>!1},scrollX:{type:Number,default:()=>null},pageSize:{type:Number,default:()=>0}},setup(e){var w;const n=X(),l=v(0),u=v(!1),s=v({});(w=e.filters)==null||w.forEach(f=>{const c=f;if(!!c.defaultValue)switch(c.type){case m.DateRange:{const b=c.key.split(":"),D=c.defaultValue;b.forEach((x,k)=>{s.value[x]=D[k]});break}default:s.value[c.key]=c.defaultValue}});const p=async()=>{if(!u.value)try{u.value=!0,await e.fetch(Object.assign({limit:e.limit,offset:l.value},s.value))}catch(f){q(n,f)}finally{u.value=!1}};return e.disableAutoFetch||oe(()=>{p()}),{processing:u,fetchData:p,filterParams:s,offset:l}},render(){const{offset:e,fetchData:n,filterParams:l,$slots:u,processing:s}=this,{columns:p,data:w,limit:f,filters:c,title:b,hidePagination:D,scrollX:x,pageSize:k}=this.$props,z=w,F=Math.ceil(z.count/f),U=Math.floor(e/f)+1,A={\u6700\u8FD11\u5C0F\u65F6:[Date.now()-3600*1e3,Date.now()],\u6700\u8FD13\u5C0F\u65F6:[Date.now()-3*3600*1e3,Date.now()],\u6700\u8FD16\u5C0F\u65F6:[Date.now()-3*3600*1e3,Date.now()],\u4ECA\u5929:[j().getTime(),Date.now()],\u6628\u5929:[H().getTime(),j().getTime()-1],\u6700\u8FD13\u5929:[B(2).getTime(),Date.now()],\u6700\u8FD17\u5929:[B(6).getTime(),Date.now()]},d="large";let I=0;const h=c.map(y=>{const t=y,T=t.span||6;I+=T;let o;switch(t.type){case m.Select:o=a(O,{filterable:!0,defaultValue:t.defaultValue,size:d,options:t.options||[],placeholder:t.placeholder,onUpdateValue:r=>{l[t.key]=r}},null);break;case m.MultiSelect:o=a(O,{filterable:!0,defaultValue:t.defaultValue,size:d,multiple:!0,options:t.options||[],placeholder:t.placeholder,onUpdateValue:r=>{let g="";r&&(g=r.join(",")),l[t.key]=g}},null);break;case m.InputNumber:o=a(M,{class:"widthFull",size:d,placeholder:t.placeholder,defaultValue:t.defaultValue,"onUpdate:value":r=>{l[t.key]=r}},null);break;case m.InputDuration:o=a(W,null,{default:()=>[a(M,{class:"widthFull",size:d,placeholder:t.placeholder,defaultValue:R(t.defaultValue)||null,"onUpdate:value":r=>{l[t.key]=`${r||0}s`}},null),a(Q,{size:d},{default:()=>[E("\u79D2")]})]});break;case m.DateRange:{let r=null;if(t.defaultValue){const i=t.defaultValue;r=[Date.now(),Date.now()],i.forEach((L,V)=>{r&&(r[V]=new Date(L).getTime())})}let g=t.placeholder,C=t.placeholder;if(t.placeholder){const i=t.placeholder.split(":");i.length===2&&(g=i[0],C=i[1])}o=a(K,{class:"widthFull",format:"yyyy-MM-dd HH:mm:ss",size:d,defaultValue:r,"start-placeholder":g,"end-placeholder":C,ranges:A,type:"daterange",clearable:!0,onUpdateValue:i=>{t.key.split(":").forEach((V,P)=>{if(!i||i.length<=P){l[V]="";return}l[V]=new Date(i[P]).toISOString()})}},null);break}default:o=a($,{clearable:!0,size:d,placeholder:t.placeholder,defaultValue:t.defaultValue,onUpdateValue:r=>{l[t.key]=r.trim()}},null);break}return a(G,{span:T},{default:()=>[a(Y,{label:t.name},S(o)?o:{default:()=>[o]})]})});if(h.length!==0){const y=24-I%24;h.push(a(G,{span:y},{default:()=>[a(_,{class:"widthFull",size:d,onClick:()=>{this.offset=0,n()}},{default:()=>[E("\u7B5B\u9009")]})]}))}const N=a("div",{class:"clearfix"},[a(Z,{show:s},{default:()=>[h.length!==0&&a(ee,{labelPlacement:"left"},{default:()=>[a(te,{xGap:24},S(h)?h:{default:()=>[h]})]}),a(ae,{columns:p,data:z.items,scrollX:x,pagination:k===0?void 0:{pageSize:k}},null),!D&&F>1&&a(le,{page:U,pageCount:F,class:pe,onUpdatePage:y=>{this.offset=(y-1)*f,n()}},null),u.default&&u.default()]})]);return b?a(ne,{title:b},S(N)?N:{default:()=>[N]}):N}});export{xe as E,fe as a,Ve as b,ke as c,Ne as d,De as n};
