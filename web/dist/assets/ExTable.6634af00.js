import{K as P,L as A,M as j,J as H,s as R}from"./index.1e068ea3.js";import{F as m}from"./ExFormInterface.d1e14f35.js";import{u as q,y as X,H as $,E as B,F as K,G as Q,B as M,x as W,w as O,d as G,s as Y,t as Z,v as ee,I as te,J as ae,r as le,e as ne}from"./naive.650dd42a.js";import{h as _,E as re,G as a,D as se,r as v,b as ue,f as E,J as oe}from"./ui.c327b114.js";const ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 576 512"},ce=a("path",{d:"M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9L216.2 301.8l-7.3 65.3l65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1l30.9-30.9c4-4.2 4-10.8-.1-14.9z",fill:"currentColor"},null,-1);var de=_({name:"EditRegular",render:function(n,l){return se(),re("svg",ie,[ce])}});function S(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!oe(e)}const fe="pyx5alf",pe="u13tuy86";function be(e){return{title:e.title,key:e.key,width:e.width,render:n=>{const l=n[e.key];if(!l||l.length===0)return"--";const u=l.map(s=>a("li",null,[s]));return a("ul",{class:pe},[u])}}}function ke(e){return{title:e.title,width:e.width,key:e.key,render:n=>{const l=e.key.split("."),u=l.pop()||"";let s=n;return l.forEach(p=>s=s[p]),a("span",null,[s[u]])}}}function Ve(e){return{title:"\u64CD\u4F5C",key:"op",width:80,render(n){return a(G,{bordered:!1,onClick:()=>{e(n)}},{default:()=>[a(ne,null,{default:()=>[a(de,null,null)]}),E("\u66F4\u65B0")]})}}}function he(e){if(e.length<2)return!1;const n=e[0],l=e[e.length-1];return!(n!=="{"&&n!=="["||l!=="}"&&l!=="]")}function Ne(e){return{type:"expand",expandable:()=>!0,renderExpand:n=>{const l=n[e];return he(l.trim())?a("pre",null,[JSON.stringify(JSON.parse(l),null,2)]):l}}}var De=_({name:"ExTable",props:{title:{type:String,default:""},columns:{type:Array,required:!0},data:{type:Object,required:!0},fetch:{type:Function,required:!0},limit:{type:Number,default:15},filters:{type:Array,default:()=>[]},hidePagination:{type:Boolean,default:()=>!1},disableAutoFetch:{type:Boolean,default:()=>!1},scrollX:{type:Number,default:()=>null}},setup(e){var w;const n=q(),l=v(0),u=v(!1),s=v({});(w=e.filters)==null||w.forEach(f=>{const c=f;if(!!c.defaultValue)switch(c.type){case m.DateRange:{const b=c.key.split(":"),D=c.defaultValue;b.forEach((x,k)=>{s.value[x]=D[k]});break}default:s.value[c.key]=c.defaultValue}});const p=async()=>{if(!u.value)try{u.value=!0,await e.fetch(Object.assign({limit:e.limit,offset:l.value},s.value))}catch(f){R(n,f)}finally{u.value=!1}};return e.disableAutoFetch||ue(()=>{p()}),{processing:u,fetchData:p,filterParams:s,offset:l}},render(){const{offset:e,fetchData:n,filterParams:l,$slots:u,processing:s}=this,{columns:p,data:w,limit:f,filters:c,title:b,hidePagination:D,scrollX:x}=this.$props,k=w,F=Math.ceil(k.count/f),J=Math.floor(e/f)+1,U={\u6700\u8FD11\u5C0F\u65F6:[Date.now()-3600*1e3,Date.now()],\u6700\u8FD13\u5C0F\u65F6:[Date.now()-3*3600*1e3,Date.now()],\u6700\u8FD16\u5C0F\u65F6:[Date.now()-3*3600*1e3,Date.now()],\u4ECA\u5929:[P().getTime(),Date.now()],\u6628\u5929:[A().getTime(),P().getTime()-1],\u6700\u8FD13\u5929:[j(2).getTime(),Date.now()],\u6700\u8FD17\u5929:[j(6).getTime(),Date.now()]},d="large";let I=0;const h=c.map(y=>{const t=y,z=t.span||6;I+=z;let o;switch(t.type){case m.Select:o=a(M,{filterable:!0,defaultValue:t.defaultValue,size:d,options:t.options||[],placeholder:t.placeholder,onUpdateValue:r=>{l[t.key]=r}},null);break;case m.MultiSelect:o=a(M,{filterable:!0,defaultValue:t.defaultValue,size:d,multiple:!0,options:t.options||[],placeholder:t.placeholder,onUpdateValue:r=>{let g="";r&&(g=r.join(",")),l[t.key]=g}},null);break;case m.InputNumber:o=a(B,{class:"widthFull",size:d,placeholder:t.placeholder,defaultValue:t.defaultValue,"onUpdate:value":r=>{l[t.key]=r}},null);break;case m.InputDuration:o=a(Q,null,{default:()=>[a(B,{class:"widthFull",size:d,placeholder:t.placeholder,defaultValue:H(t.defaultValue)||null,"onUpdate:value":r=>{l[t.key]=`${r||0}s`}},null),a(K,{size:d},{default:()=>[E("\u79D2")]})]});break;case m.DateRange:{let r=null;if(t.defaultValue){const i=t.defaultValue;r=[Date.now(),Date.now()],i.forEach((C,N)=>{r&&(r[N]=new Date(C).getTime())})}let g=t.placeholder,T=t.placeholder;if(t.placeholder){const i=t.placeholder.split(":");i.length===2&&(g=i[0],T=i[1])}o=a($,{class:"widthFull",format:"yyyy-MM-dd HH:mm:ss",size:d,defaultValue:r,"start-placeholder":g,"end-placeholder":T,ranges:U,type:"daterange",clearable:!0,onUpdateValue:i=>{t.key.split(":").forEach((N,L)=>{if(!i||i.length<=L){l[N]="";return}l[N]=new Date(i[L]).toISOString()})}},null);break}default:o=a(X,{clearable:!0,size:d,placeholder:t.placeholder,defaultValue:t.defaultValue,onUpdateValue:r=>{l[t.key]=r.trim()}},null);break}return a(O,{span:z},{default:()=>[a(W,{label:t.name},S(o)?o:{default:()=>[o]})]})});if(h.length!==0){const y=24-I%24;h.push(a(O,{span:y},{default:()=>[a(G,{class:"widthFull",size:d,onClick:()=>{this.offset=0,n()}},{default:()=>[E("\u7B5B\u9009")]})]}))}const V=a("div",{class:"clearfix"},[a(Y,{show:s},{default:()=>[h.length!==0&&a(Z,{labelPlacement:"left"},{default:()=>[a(ee,{xGap:24},S(h)?h:{default:()=>[h]})]}),a(te,{columns:p,data:k.items,scrollX:x},null),!D&&F>1&&a(ae,{page:J,pageCount:F,class:fe,onUpdatePage:y=>{this.offset=(y-1)*f,n()}},null),u.default&&u.default()]})]);return b?a(le,{title:b},S(V)?V:{default:()=>[V]}):V}});export{De as E,de as a,Ve as b,be as c,ke as d,Ne as n};
