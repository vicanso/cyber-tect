import{d as w}from"./detector.f4c77658.js";import{B as V,C as b,u as z,y as k,D as U,E as h,F as I,G as S,H as F,x as v,w as x,d as g,v as j,t as D}from"./naive.650dd42a.js";import{h as N,r as i,G as a,f as E,J as G}from"./ui.c327b114.js";import{F as d}from"./ExFormInterface.d1e14f35.js";import{s as T,J as q}from"./index.14cddf8e.js";var O=N({name:"UserSelect",props:{formItem:{type:Object,required:!0},size:{type:String,required:!0},multiple:{type:Boolean,default:!0},onUpdateValue:{type:Function,required:!0}},setup(){const s=i([]),n=i(!1);return{options:s,loading:n,onSearch:async c=>{n.value=!0;try{const r=await w(c);s.value=r.map(o=>({label:o,value:o}))}finally{n.value=!1}}}},render(){const{formItem:s,size:n,multiple:t}=this.$props,{loading:c,options:r,onSearch:o,onUpdateValue:f}=this;return a(V,{multiple:t,defaultValue:s.defaultValue,size:n,filterable:!0,clearable:!0,options:r,placeholder:s.placeholder,loading:c,onUpdateValue:f,remote:!0,onSearch:o},null)}});function m(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Object]"&&!G(s)}var M=N({name:"ExForm",props:{formItems:{type:Array,required:!0},onSubmit:{type:Function,required:!0},submitText:{type:String,default:"\u63D0\u4EA4"},rules:{type:Object,default:null}},setup(s){const n=i({}),t=i({});s.formItems.forEach(o=>{o.defaultValue&&b(t.value,o.key,o.defaultValue)});const c=()=>new Promise((o,f)=>{n.value.validate(p=>{if(p){const e=p.map(u=>u.map(l=>l.message).join(","));f(new Error(e.join(";")));return}o()})}),r=z();return{handleSubmit:async o=>{try{await c()}catch(f){T(r,f);return}return s.onSubmit(o)},params:t,formRef:n}},render(){const{submitText:s,rules:n}=this.$props,{params:t,handleSubmit:c}=this,r="large",o=(e,u)=>a(V,{filterable:!0,multiple:u,defaultValue:e.defaultValue,size:r,options:e.options||[],placeholder:e.placeholder,onUpdateValue:l=>{b(t,e.key,l)}},null),p=this.$props.formItems.map(e=>{let u;switch(e.type){case d.Blank:u=a("div",null,null);break;case d.MultiSelect:u=o(e,!0);break;case d.Select:u=o(e,!1);break;case d.MultiUserSelect:u=a(O,{formItem:e,multiple:!0,size:r,onUpdateValue:l=>{t[e.key]=l}},null);break;case d.DateTime:{let l=null;e.defaultValue&&(l=new Date(e.defaultValue).getTime()),u=a(F,{type:"datetime",class:"widthFull",size:r,placeholder:e.placeholder,defaultValue:l,clearable:!0,onUpdateValue:y=>{y?t[e.key]=new Date(y).toISOString():t[e.key]=""}},null)}break;case d.InputNumber:u=a(h,{class:"widthFull",disabled:e.disabled||!1,size:r,placeholder:e.placeholder,defaultValue:e.defaultValue||null,"onUpdate:value":l=>{t[e.key]=l}},null);break;case d.InputNumberGroup:u=a(S,null,{default:()=>[a(h,{class:"widthFull",disabled:e.disabled||!1,size:r,placeholder:e.placeholder,defaultValue:e.defaultValue||null,"onUpdate:value":l=>{t[e.key]=l}},null),e.suffix&&a(I,{size:r},{default:()=>[e.suffix]})]});break;case d.InputDuration:u=a(S,null,{default:()=>[a(h,{class:"widthFull",disabled:e.disabled||!1,size:r,placeholder:e.placeholder,defaultValue:q(e.defaultValue)||null,"onUpdate:value":l=>{t[e.key]=`${l}s`}},null),a(I,{size:r},{default:()=>[E("\u79D2")]})]});break;case d.TextArea:u=a(k,{type:"textarea",autosize:{minRows:3,maxRows:5},disabled:e.disabled||!1,size:r,placeholder:e.placeholder,defaultValue:e.defaultValue||"",onUpdateValue:l=>{t[e.key]=l},clearable:!0},null);break;case d.DynamicInput:u=a(U,{placeholder:e.placeholder,defaultValue:e.defaultValue||[],onUpdateValue:l=>{t[e.key]=l},min:e.min,max:e.max},null);break;default:u=a(k,{disabled:e.disabled||!1,size:r,placeholder:e.placeholder,defaultValue:e.defaultValue||"",onUpdateValue:l=>{b(t,e.key,l)},clearable:!0},null);break}return a(x,{span:e.span||8},{default:()=>[a(v,{label:e.name,path:e.key},m(u)?u:{default:()=>[u]})]})});return p.push(a(x,{span:24},{default:()=>[a(g,{size:r,class:"widthFull",onClick:()=>c(t)},m(s)?s:{default:()=>[s]})]})),a(D,{labelPlacement:"left",rules:n,model:t,ref:"formRef"},{default:()=>[a(j,{xGap:24},m(p)?p:{default:()=>[p]})]})}});export{M as E};
