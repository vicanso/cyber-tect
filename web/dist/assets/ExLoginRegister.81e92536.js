import{w as v,s as b,q as C,x,y as N,z as E,A as L,B as j}from"./index.1e068ea3.js";import{h as R,r as p,b as V,G as e,f as q,J as z}from"./ui.c327b114.js";import{u as G,t as T,x as g,y as h,v as I,w as y,d as O,r as $}from"./naive.650dd42a.js";function k(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!z(t)}const w="login",B="c1eq9ar",P="c1ppv7dc",S="sd1d3ho",U="cvblerb";var M=R({name:"ExLoginRegister",props:{type:{type:String,default:w}},setup(t){const r=p({account:"",password:"",captcha:""}),s=G(),c=t.type===w,l=p(!1),o=p(j()),n=async()=>{try{o.value.id="";const a=await v();o.value=a}catch(a){b(s,a)}},u=async()=>{if(l.value)return;const{account:a,password:m,captcha:f}=r.value;if(!a||!m||!f){C(s,"\u8D26\u53F7\u3001\u5BC6\u7801\u53CA\u56FE\u5F62\u9A8C\u8BC1\u7801\u5747\u4E0D\u80FD\u4E3A\u7A7A");return}try{l.value=!0;const d={account:a,password:m,captcha:`${o.value.id}:${f}`};c?await x(d):await N(d),c?E(!0):L(!0)}catch(d){b(s,d),n()}finally{l.value=!1}},i=a=>{a.code==="Enter"&&u()};return V(()=>{n()}),{refreshCaptcha:n,loginOrRegister:u,handleEnterPress:i,isLogin:c,captchaData:o,model:r,processing:l,rules:{account:{required:!0,message:"\u8D26\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},password:{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},captcha:{required:!0,message:"\u56FE\u5F62\u9A8C\u8BC1\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}}}},render(){const t="large",{model:r,captchaData:s,rules:c,processing:l,isLogin:o,handleEnterPress:n}=this,u=o?"\u7528\u6237\u767B\u5F55":"\u7528\u6237\u6CE8\u518C",i=o?"\u767B\u5F55":"\u6CE8\u518C";return e($,{title:u,class:B},{default:()=>[e(T,{labelWidth:"100",labelAlign:"right",labelPlacement:"left",size:t,rules:c,model:r},{default:()=>[e(g,{label:"\u8D26\u53F7\uFF1A",path:"account"},{default:()=>[e(h,{placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",clearable:!0,autofocus:!0,onUpdateValue:a=>{r.account=a}},null)]}),e(g,{label:"\u5BC6\u7801\uFF1A",path:"password"},{default:()=>[e(h,{type:"password",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",clearable:!0,"show-password-on":"click",onUpdateValue:a=>{r.password=a}},null)]}),e(g,{label:"\u9A8C\u8BC1\u7801\uFF1A",path:"captcha"},{default:()=>[e(I,{cols:4},{default:()=>[e(y,{span:3},{default:()=>[e(h,{placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",maxlength:4,clearable:!0,onKeyup:n,onUpdateValue:a=>{r.captcha=a}},null)]}),e(y,{span:1},{default:()=>[e("div",{class:P,onClick:this.refreshCaptcha},[s.id&&e("img",{class:U,src:`data:image/${s.type};base64,${s.data}`},null),!s.id&&e("span",null,[q("...")])])]})]})]}),e(O,{loading:l,class:S,size:t,onClick:this.loginOrRegister},k(i)?i:{default:()=>[i]})]})]})}});export{M as E};
